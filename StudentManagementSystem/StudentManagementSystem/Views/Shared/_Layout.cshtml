<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - StudentManagementSystem</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/StudentManagementSystem.styles.css" asp-append-version="true" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <style>
                body {
                        margin: 0;
                        padding: 0;
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        background-color: #f5f5f5;

        }

                .main-container {
                        display: flex;
                        min-height: 100vh;

        }


        /* Orange Sidebar Styling - FIXED TO LEFT SIDE */
                .sidebar {
                        width: 280px;
                        background: linear-gradient(135deg, #ff8c42, #ff6b1a);
                        color: white;
                        padding: 0;
                        box-shadow: 2px 0 10px rgba(0,0,0,0.1);
                        position: fixed;
                        top: 0;
                        left: 0;
                        height: 100vh;
                        overflow-y: auto;
                        z-index: 1000;
                        transition: transform 0.3s ease;
                        border-radius: 0 20px 20px 0;

        }


        /* Collapsed sidebar state */
                    .sidebar.collapsed {
                            transform: translateX(-240px);

        }


        /* Logo Section */
                .logo-section {
                        padding: 30px 20px;
                        text-align: left;
                        border-bottom: 1px solid rgba(255,255,255,0.2);
                        display: flex; /* إضافة display: flex */
                        align-items: center; /* لمحاذاة العناصر عمودياً */
                        justify-content: space-between; /* لتوزيع العناصر بشكل متساوٍ */

        }

                .logo-container {
                        display: flex;
                        align-items: center;
                        gap: 15px;

        }

                .logo-placeholder {
                        width: 50px;
                        height: 50px;
                        background-color: rgba(255,255,255,0.2);
                        border: 2px solid white;
                        border-radius: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;

        }

                .logo-image {
                        width: 25%;
                        height: 25%;
                        object-fit: contain;
                        border-radius: 6px;

        }

                .brand-text {
                        font-size: 20px;
                        font-weight: bold;
                        letter-spacing: 1px;
                        transition: opacity 0.3s ease;

        }


        /* Hide text when collapsed */
                .sidebar.collapsed .brand-text {
                        opacity: 0;

        }


        /* Profile icon */
                .profile-icon {
                        color: white;
                        font-size: 24px;
                        transition: transform 0.3s ease;

        }

                    .profile-icon:hover {
                            color: #ffeb3b; /* لون عند المرور بالماوس */
                            transform: scale(1.1);

        }


        /* Navigation Menu */
                .nav-menu {
                        padding: 20px 0;
                        flex: 1;

        }

                .nav-item {
                        margin-bottom: 8px;
                        padding: 0 20px;

        }

                .nav-link-custom {
                        display: flex;
                        align-items: center;
                        padding: 15px 20px;
                        color: white;
                        text-decoration: none;
                        font-size: 16px;
                        font-weight: 500;
                        transition: all 0.3s ease;
                        border-radius: 25px;
                        position: relative;
                        white-space: nowrap;
                        margin: 0;

        }

                    .nav-link-custom:hover {
                            background-color: rgba(255,255,255,0.1);
                            color: white;
                            text-decoration: none;

        }

                    .nav-link-custom.active {
                            background-color: white;
                            color: #ff6b1a;
                            font-weight: 600;
                            box-shadow: 0 4px 15px rgba(0,0,0,0.1);

        }

                    .nav-link-custom i {
                            width: 24px;
                            margin-right: 15px;
                            font-size: 18px;
                            flex-shrink: 0;

        }

                .nav-text {
                        transition: opacity 0.3s ease;

        }


        /* Hide nav text when collapsed */
                .sidebar.collapsed .nav-text {
                        opacity: 0;

        }


        /* Logout Button */
                .logout-section {
                        padding: 20px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                        margin-top: auto;

        }

                .logout-btn {
                        display: flex;
                        align-items: center;
                        padding: 12px 20px;
                        background-color: rgba(255,255,255,0.15);
                        color: white;
                        text-decoration: none;
                        border-radius: 25px;
                        font-size: 16px;
                        font-weight: 500;
                        transition: all 0.3s ease;
                        border: 1px solid rgba(255,255,255,0.3);
                        white-space: nowrap;

        }

                    .logout-btn:hover {
                            background-color: rgba(255,255,255,0.25);
                            color: white;
                            transform: translateY(-2px);
                            text-decoration: none;

        }

                    .logout-btn i {
                            margin-right: 10px;
                            flex-shrink: 0;

        }


        /* Hide logout text when collapsed */
                .sidebar.collapsed .logout-btn .logout-text {
                        opacity: 0;

        }


        /* Drawer-Style Toggle Button */
                .sidebar-toggle {
                        position: fixed;
                        top: 50%;
                        left: 280px;
                        transform: translateY(-50%);
                        z-index: 1001;
                        background: #ff6b1a;
                        color: white;
                        border: none;
                        padding: 0;
                        width: 30px;
                        height: 60px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        box-shadow: 2px 0 10px rgba(0,0,0,0.2);
                        border-radius: 0 10px 10px 0;
                        display: flex;
                        align-items: center;
                        justify-content: center;

        }

                    .sidebar-toggle:hover {
                            background: #ff8c42;
                            width: 35px;

        }


        /* Adjust toggle button position when sidebar is collapsed */
                    .sidebar.collapsed + .sidebar-toggle,
                    .sidebar-toggle.collapsed-position {
                            left: 40px;

        }

                .toggle-handle {
                        width: 4px;
                        height: 20px;
                        background: white;
                        border-radius: 2px;
                        opacity: 0.8;
                        transition: all 0.3s ease;

        }

                .sidebar-toggle:hover .toggle-handle {
                        opacity: 1;
                        height: 25px;

        }


        /* Content Area - FIXED TO START AFTER SIDEBAR */
                .content-area {
                        margin-left: 280px;
                        flex: 1;
                        background-color: #f8f9fa;
                        min-height: 100vh;
                        transition: margin-left 0.3s ease;

        }


        /* Adjust content area when sidebar is collapsed */
                    .content-area.sidebar-collapsed {
                            margin-left: 40px;

        }


        /* Hide original navbar when sidebar is active */
                .original-navbar {
                        display: none;

        }


        /* Original container styling for content */
                .content-container {
                        padding: 20px;

        }


        /* Page Header */
                .page-header {
                        background-color: white;
                        padding: 20px 30px;
                        border-radius: 15px;
                        box-shadow: 0 2px 15px rgba(0,0,0,0.08);
                        margin-bottom: 20px;

        }


        /* Footer adjustments */
                .modern-footer {
                        margin-left: 280px;
                        background: linear-gradient(135deg, #ffffff, #f8f9fa);
                        border-top: 1px solid rgba(255, 107, 26, 0.1);
                        padding: 20px 0;
                        transition: margin-left 0.3s ease;
                        box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                        backdrop-filter: blur(10px);

        }


        /* Adjust footer when sidebar is collapsed */
                .footer.sidebar-collapsed {
                        margin-left: 40px;

        }

                .footer-content {
                        max-width: 1200px;
                        margin: 0 auto;
                        padding: 0 30px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        flex-wrap: wrap;
                        gap: 15px;

        }

                .footer-left {
                        display: flex;
                        align-items: center;

        }

                .footer-copyright {
                        color: #6c757d;
                        font-size: 14px;
                        font-weight: 500;
                        letter-spacing: 0.3px;

        }

                .footer-right {
                        display: flex;
                        align-items: center;

        }

                .footer-link {
                        color: #ff6b1a;
                        text-decoration: none;
                        font-size: 14px;
                        font-weight: 500;
                        padding: 8px 16px;
                        border-radius: 20px;
                        transition: all 0.3s ease;
                        position: relative;
                        overflow: hidden;

        }

                    .footer-link::before {
                            content: '';
                            position: absolute;
                            top: 0;
                            left: -100%;
                            width: 100%;
                            height: 100%;
                            background: linear-gradient(90deg, transparent, rgba(255, 107, 26, 0.1), transparent);
                            transition: left 0.5s ease;

        }

                    .footer-link:hover {
                            color: #ff8c42;
                            background-color: rgba(255, 107, 26, 0.05);
                            transform: translateY(-1px);
                            text-decoration: none;

        }

                        .footer-link:hover::before {
                                left: 100%;

        }



        /* Mobile sidebar toggle */
                .mobile-toggle {
                        display: none;
                        position: fixed;
                        top: 15px;
                        left: 15px;
                        z-index: 1002;
                        background: #ff6b1a;
                        color: white;
                        border: none;
                        padding: 10px;
                        border-radius: 5px;
                        font-size: 18px;

        }


        /* Responsive Design */
                @@media (max-width: 768px) {
                        .sidebar        

        {
                        transform: translateX(-100%);
                        border-radius: 0 20px 20px 0;

        }

                .sidebar.show {
                        transform: translateX(0);

        }

                .sidebar.collapsed {
                        transform: translateX(-100%);

        }

                .content-area {
                        margin-left: 0;

        }

                    .content-area.sidebar-collapsed {
                            margin-left: 0;

        }

                .footer {
                        margin-left: 0;

        }

                    .footer.sidebar-collapsed {
                            margin-left: 0;

        }

                .sidebar-toggle {
                        display: none;

        }

                .mobile-toggle {
                        display: block;

        }

                .original-navbar {
                        display: block;
                        margin-left: 0;

        }


        }

    </style>
</head>
<body>
    <button class="mobile-toggle" onclick="toggleMobileSidebar()">
        <i class="fas fa-bars"></i>
    </button> 

    <div class="main-container">
        <nav class="sidebar" id="sidebar">
            <div class="logo-section">
                <div class="logo-container">
                    <img src="~/images/FathallaLogo.png" alt="FATHALLA Logo" class="logo-image" />
                    <div class="brand-text">FATHALLA</div>
                </div>

                <a asp-controller="Account" asp-action="UserProfile" class="profile-icon">
                    <i class="fas fa-user-circle"></i>
                </a>
            </div>

            @if (User.IsInRole("Admin"))
            {
                <div class="nav-menu">
                    <div class="nav-item">
                        <a asp-controller="Dashboard" asp-action="Index" class="nav-link-custom" data-page="dashboard">
                            <i class="fas fa-th-large"></i>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Competences" asp-action="Index" class="nav-link-custom" data-page="competences">
                            <i class="fas fa-users"></i>
                            <span class="nav-text">Competences</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Attendance" asp-action="Index" class="nav-link-custom" data-page="attendance">
                            <i class="fas fa-calendar-check"></i>
                            <span class="nav-text">Attendance</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Student" asp-action="Index" class="nav-link-custom" data-page="student">
                            <i class="fas fa-user-graduate"></i>
                            <span class="nav-text">Students</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Grade" asp-action="Index" class="nav-link-custom" data-page="grade">
                            <i class="fas fa-star"></i>
                            <span class="nav-text">Grade</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="WorkingYear" asp-action="Index" class="nav-link-custom" data-page="workingyear">
                            <i class="fas fa-calendar-alt"></i>
                            <span class="nav-text">Working Year</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Class" asp-action="Index" class="nav-link-custom" data-page="class">
                            <i class="fas fa-chalkboard"></i>
                            <span class="nav-text">Class</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Department" asp-action="Index" class="nav-link-custom" data-page="department">
                            <i class="fas fa-building"></i>
                            <span class="nav-text">Department</span>
                        </a>
                    </div>

                    <div class="nav-item">
                        <a asp-controller="Section" asp-action="Index" class="nav-link-custom" data-page="section">
                            <i class="fas fa-layer-group"></i>
                            <span class="nav-text">Section</span>
                        </a>
                    </div>
                </div>
            }

            <div class="logout-section">
                @if (User.Identity.IsAuthenticated)
                {
                    <a asp-controller="Account" asp-action="Logout" class="logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span class="logout-text">Logout</span>
                    </a>
                }
                else
                {
                    <a asp-controller="Account" asp-action="Login" class="logout-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        <span class="logout-text">Login</span>
                    </a>
                }
            </div>
        </nav>

        <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">
            <div class="toggle-handle"></div>
        </button>

        <div class="content-area" id="contentArea">
            <header class="original-navbar">
                <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
                    <div class="container-fluid">
                        <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">StudentManagementSystem</a>
                        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                                                aria-expanded="false" aria-label="Toggle navigation">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                       @*  <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                            <ul class="navbar-nav flex-grow-1">
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index">Home</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
                                </li>
                            </ul>
                        </div> *@
                    </div>
                </nav>
            </header>

            <div class="content-container">
                <main role="main" class="pb-3">
                    @RenderBody()
                </main>
            </div>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    <script>
        // Desktop sidebar toggle functionality
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const contentArea = document.getElementById('contentArea');
            const footer = document.getElementById('footer');
            const toggleBtn = document.getElementById('sidebarToggle');

            // Toggle collapsed state
            sidebar.classList.toggle('collapsed');
            contentArea.classList.toggle('sidebar-collapsed');
            if (footer) footer.classList.toggle('sidebar-collapsed');
            toggleBtn.classList.toggle('collapsed-position');
        }

        // Mobile sidebar toggle functionality
        function toggleMobileSidebar() {
            document.getElementById('sidebar').classList.toggle('show');
        }

        // Enhanced active navigation detection
        document.addEventListener('DOMContentLoaded', function() {
            const currentPath = window.location.pathname.toLowerCase();
            const currentController = getControllerFromPath(currentPath);

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link-custom').forEach(link => {
                link.classList.remove('active');
            });

            // Add active class based on current controller
            const activeLink = document.querySelector(`[data-page="${currentController}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            } else {
                // Default to dashboard if no match found
                const dashboardLink = document.querySelector('[data-page="dashboard"]');
                if (dashboardLink) dashboardLink.classList.add('active');
            }
        });

        // Helper function to extract controller from path
        function getControllerFromPath(path) {
            // Remove leading slash and split by slash
            const segments = path.replace(/^\/+/, '').split('/');

            if (segments.length === 0 || segments[0] === '' || segments[0] === 'home') {
                return 'dashboard';
            }

            // Map controllers to their data-page values
            const controllerMap = {
                'competences': 'competences',
                'attendance': 'attendance',
                'student': 'student',
                'grade': 'grade',
                'workingyear': 'workingyear',
                'class': 'class',
                'department': 'department',
                'section': 'section'
            };

            const controller = segments[0].toLowerCase();
            return controllerMap[controller] || 'dashboard';
        }

        // Close mobile sidebar when clicking outside
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const mobileToggleBtn = document.querySelector('.mobile-toggle');

            if (window.innerWidth <= 768 &&
                !sidebar.contains(event.target) &&
                !mobileToggleBtn.contains(event.target)) {
                sidebar.classList.remove('show');
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            const sidebar = document.getElementById('sidebar');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('show');
            }
        });
    </script>

    @await RenderSectionAsync("Scripts", required: false)
</body>

@* <footer class="modern-footer" id="footer">
    <div class="footer-content">
        <div class="footer-left">
            <span class="footer-copyright">&copy; 2025 Student Management System</span>
        </div>
        <div class="footer-right">
            <a asp-controller="Home" asp-action="Privacy" class="footer-link">Privacy Policy</a>
        </div>
    </div>
</footer> *@

</html>